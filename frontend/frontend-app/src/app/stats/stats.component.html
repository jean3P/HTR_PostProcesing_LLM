<h2>OCR Model Comparison with LLM Across Different Datasets</h2>

<div class="selection-container">
  <div class="selection-item">
    <label for="htrModel">HTR Model:</label>
    <select id="htrModel" (change)="onModelChange($event)">
      <option value="Flor_model">Flor_model</option>
      <option value="TrOCR_model">TrOCR_model</option>
    </select>
  </div>

  <div class="selection-item">
    <label for="llmName">LLM Model:</label>
    <select id="llmName" (change)="onLlmChange($event)">
      <option value="mistral">Mistral</option>
      <option value="gpt-3.5">GPT-3.5</option>
    </select>
  </div>

  <div class="selection-item">
    <label for="nameMethod">Name Method:</label>
    <select id="nameMethod" (change)="onMethodChange($event)">
      <option value="method_1">Method 1</option>
      <option value="method_2">Method 2</option>
    </select>
  </div>
</div>

<table class="styled-table">
  <thead>
  <tr>
    <th>Train (%)</th>
<!--    <th>Model</th>-->
    <th>OCR CER (%)</th>
    <th colspan="2">Washington</th>
    <th colspan="2">Bentham</th>
    <th colspan="2">Whitefield</th>
    <th colspan="2">IAM</th>
    <th colspan="2">No Training Set</th>
  </tr>
  <tr>
    <th></th>
    <th></th>
    <th>CER</th>
    <th>Reduction (%)</th>
    <th>CER</th>
    <th>Reduction (%)</th>
    <th>CER</th>
    <th>Reduction (%)</th>
    <th>CER</th>
    <th>Reduction (%)</th>
    <th>CER</th>
    <th>Reduction (%)</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let statGroup of statistics">
    <td>{{ statGroup.partition }}</td>
<!--    <td>{{ selectedHtrModel }}</td>-->
    <td>{{ statGroup.averageCerOcr || '-' }}</td>

    <!-- Washington -->
    <td [ngClass]="getClass(statGroup, 'washington') + (selectedCell === statGroup.partition + '-washington' ? ' selected-cell' : '')"
        (click)="loadEvaluationData('washington', statGroup.partition)">
      {{ statGroup.washington?.cer || '-' }}
    </td>
    <td>{{ statGroup.washington?.reduction || '-' }}</td>

    <!-- Bentham -->
    <td [ngClass]="getClass(statGroup, 'bentham') + (selectedCell === statGroup.partition + '-bentham' ? ' selected-cell' : '')"
        (click)="loadEvaluationData('bentham', statGroup.partition)">
      {{ statGroup.bentham?.cer || '-' }}
    </td>
    <td>{{ statGroup.bentham?.reduction || '-' }}</td>

    <!-- Whitefield -->
    <td [ngClass]="getClass(statGroup, 'whitefield') + (selectedCell === statGroup.partition + '-whitefield' ? ' selected-cell' : '')"
        (click)="loadEvaluationData('whitefield', statGroup.partition)">
      {{ statGroup.whitefield?.cer || '-' }}
    </td>
    <td>{{ statGroup.whitefield?.reduction || '-' }}</td>

    <!-- IAM -->
    <td [ngClass]="getClass(statGroup, 'iam') + (selectedCell === statGroup.partition + '-iam' ? ' selected-cell' : '')"
        (click)="loadEvaluationData('iam', statGroup.partition)">
      {{ statGroup.iam?.cer || '-' }}
    </td>
    <td>{{ statGroup.iam?.reduction || '-' }}</td>

    <!-- No Training Set -->
    <td [ngClass]="getClass(statGroup, 'noTraining') + (selectedCell === statGroup.partition + '-noTraining' ? ' selected-cell' : '')"
        (click)="loadEvaluationData('noTraining', statGroup.partition)">
      {{ statGroup.noTraining?.cer || '-' }}
    </td>
    <td>{{ statGroup.noTraining?.reduction || '-' }}</td>


  </tr>
  </tbody>
</table>

<!-- Filter dropdown and total row count -->
<div class="filter-container">
  <!-- Filter selection -->
  <div class="filter-item">
    <label for="evaluationFilter">Filter Evaluation Cases:</label>
    <select id="evaluationFilter" (change)="onFilterChange($event)">
      <option value="all">All</option>
      <option value="llm_greater">LLM > OCR</option>
      <option value="llm_lesser">LLM < OCR</option>
      <option value="llm_equal">LLM = OCR</option>
    </select>
  </div>
  <!-- Row count display -->
  <div class="total-rows">
    Total Rows: {{ filteredEvaluationData.length }}
  </div>
  <!-- Clear table button -->
  <button class="clear-button" (click)="clearTable()">Clear Table</button>
</div>


<!-- Evaluation Data Table -->
<h2 *ngIf="selectedEvaluationData.length">Evaluation Details</h2>
<table *ngIf="filteredEvaluationData.length" class="styled-table">
  <thead>
  <tr>
    <th>File Name</th>
    <th>Ground Truth</th>
    <th>Predicted Text (OCR)</th>
    <th>Predicted Text (LLM)</th>
    <th>CER (LLM)</th>
    <th>CER (OCR)</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let data of filteredEvaluationData">
    <td>{{ data.fileName }}</td>
    <td>{{ data.groundTruth }}</td>
    <td>{{ data.predictedTextOcr }}</td>
    <td>{{ data.predictedTextLlm }}</td>
    <td>{{ data.cerLlm }}</td>
    <td>{{ data.cerOcr }}</td>
  </tr>
  </tbody>
</table>
